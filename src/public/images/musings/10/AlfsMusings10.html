<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">.lst-kix_rmkyi9gq4jkw-0>li:before{content:"\0025cf  "}.lst-kix_rmkyi9gq4jkw-3>li:before{content:"\0025cf  "}.lst-kix_rmkyi9gq4jkw-2>li:before{content:"\0025a0  "}.lst-kix_v73jnx6lgct8-7>li:before{content:"\0025cb  "}.lst-kix_rmkyi9gq4jkw-1>li:before{content:"\0025cb  "}.lst-kix_v73jnx6lgct8-8>li:before{content:"\0025a0  "}.lst-kix_v73jnx6lgct8-0>li:before{content:"\0025cf  "}.lst-kix_v73jnx6lgct8-1>li:before{content:"\0025cb  "}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}ul.lst-kix_v73jnx6lgct8-0{list-style-type:none}.lst-kix_v73jnx6lgct8-6>li:before{content:"\0025cf  "}.lst-kix_rmkyi9gq4jkw-6>li:before{content:"\0025cf  "}.lst-kix_rmkyi9gq4jkw-8>li:before{content:"\0025a0  "}ul.lst-kix_rmkyi9gq4jkw-8{list-style-type:none}ul.lst-kix_rmkyi9gq4jkw-7{list-style-type:none}ul.lst-kix_rmkyi9gq4jkw-6{list-style-type:none}ul.lst-kix_rmkyi9gq4jkw-5{list-style-type:none}.lst-kix_v73jnx6lgct8-5>li:before{content:"\0025a0  "}ul.lst-kix_rmkyi9gq4jkw-4{list-style-type:none}.lst-kix_rmkyi9gq4jkw-7>li:before{content:"\0025cb  "}ul.lst-kix_v73jnx6lgct8-7{list-style-type:none}ul.lst-kix_rmkyi9gq4jkw-3{list-style-type:none}ul.lst-kix_v73jnx6lgct8-8{list-style-type:none}ul.lst-kix_rmkyi9gq4jkw-2{list-style-type:none}ul.lst-kix_v73jnx6lgct8-5{list-style-type:none}ul.lst-kix_rmkyi9gq4jkw-1{list-style-type:none}.lst-kix_v73jnx6lgct8-2>li:before{content:"\0025a0  "}.lst-kix_v73jnx6lgct8-4>li:before{content:"\0025cb  "}ul.lst-kix_v73jnx6lgct8-6{list-style-type:none}ul.lst-kix_rmkyi9gq4jkw-0{list-style-type:none}.lst-kix_rmkyi9gq4jkw-4>li:before{content:"\0025cb  "}ul.lst-kix_v73jnx6lgct8-3{list-style-type:none}ul.lst-kix_v73jnx6lgct8-4{list-style-type:none}ul.lst-kix_v73jnx6lgct8-1{list-style-type:none}ul.lst-kix_v73jnx6lgct8-2{list-style-type:none}.lst-kix_v73jnx6lgct8-3>li:before{content:"\0025cf  "}.lst-kix_rmkyi9gq4jkw-5>li:before{content:"\0025a0  "}ol{margin:0;padding:0}table td,table th{padding:0}.c17{padding-top:18pt;padding-bottom:6pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:justify}.c3{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c12{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:26pt;font-family:"Arial";font-style:normal}.c13{color:#434343;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:"Arial";font-style:normal}.c19{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:24pt;font-family:"Arial";font-style:normal}.c16{padding-top:16pt;padding-bottom:4pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c4{padding-top:0pt;padding-bottom:3pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:justify}.c20{padding-top:18pt;padding-bottom:6pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c10{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:23pt;font-family:"Arial";font-style:normal}.c6{padding-top:16pt;padding-bottom:4pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:justify}.c18{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9pt;font-family:"Arial";font-style:normal}.c14{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:16pt;font-family:"Arial";font-style:normal}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:justify}.c7{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:center}.c1{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c9{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c15{background-color:#ffffff;max-width:451.4pt;padding:72pt 72pt 72pt 72pt}.c5{margin-left:36pt;padding-left:0pt}.c8{color:inherit;text-decoration:inherit}.c11{padding:0;margin:0}.c2{height:11pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c15 doc-content"><div><p class="c1 c2"><span class="c3"></span></p></div><p class="c4 title" id="h.elkc3rvsujy5"><span class="c12">Alf&rsquo;s Musings #10</span></p><h2 class="c20" id="h.vaqp1w3xe878"><span class="c14">A bit of context</span></h2><p class="c0"><span>I have talked about the importance of correctly predicting the behavior of your magnetic component. If you, dear Engineer reader, don&#39;t fully model your design, you are just passing part of your responsibility to the manufacturer&#39;s Engineer, and forcing your employer to pass part of your next salary raise to that other Engineer&#39;s </span><span>employer</span><span class="c3">.</span></p><p class="c0 c2"><span class="c3"></span></p><p class="c0"><span class="c3">In this chapter of Alf&#39;s Musings we are going to further focus on the magnetizing inductance, concretely on how the air gap(s) affects it through their reluctance.</span></p><p class="c0 c2"><span class="c3"></span></p><p class="c0"><span class="c3">In an ideal world, when the magnetic flux lines traversing a high permeability magnetic core find themselves changing to a low permeability medium, like the air, they just continue perfectly straight, as if nothing had changed. </span></p><p class="c0 c2"><span class="c3"></span></p><p class="c0"><span class="c3">But because we don&#39;t live in such a world, the lines expand and separate from each other, bulging towards the exterior, until they reach the other side of the gap and they join ranks again inside the magnetic core. This effect is called Magnetic Fringing Effect and this deformed flux, Magnetic Fringing Flux. And like most things in life, it can be good and bad. Let&#39;s see how we can take advantage of it.</span></p><p class="c0 c2"><span class="c3"></span></p><p class="c7"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 335.96px; height: 262.34px;"><img alt="" src="images/image18.png" style="width: 335.96px; height: 262.34px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c18">2D Fringing Flux Simulation, taken from Encyclopedia Magnetica https://e-magnetica.pl/flux_fringing</span></p><p class="c0 c2"><span class="c3"></span></p><p class="c0"><span>The positive thing about the Fringing Flux is that it increases the volume of air that stores energy in our magnetic component, increasing also the inductance; which i</span><span>s</span><span class="c3">&nbsp;good only if we are able to predict how much, and reduce the gap length accordingly in order to achieve the values we want.</span></p><p class="c0 c2"><span class="c3"></span></p><p class="c0"><span class="c3">This effect is nothing new, known since the first half of the 20th century. In these years there have been several authors that have attempted to model this effect and predict how much of an increase the inductance will have.</span></p><p class="c0 c2"><span class="c3"></span></p><p class="c0"><span class="c3">The models covered in this study are:</span></p><ul class="c11 lst-kix_v73jnx6lgct8-0 start"><li class="c0 c5 li-bullet-0"><span class="c3">M&uuml;hlethaler</span></li><li class="c0 c5 li-bullet-0"><span class="c3">Stenglein</span></li><li class="c0 c5 li-bullet-0"><span class="c3">McLyman</span></li><li class="c0 c5 li-bullet-0"><span class="c3">Effective Area</span></li><li class="c0 c5 li-bullet-0"><span class="c3">Zhang</span></li><li class="c0 c5 li-bullet-0"><span class="c3">Classical (ignoring Fringing Effect)</span></li></ul><p class="c0 c2"><span class="c3"></span></p><p class="c0"><span class="c3">Because no model is any good without verification, I am running each of these models against a battery of tests taken from the verification section of many papers and design procedures, in order to compare them under the same conditions.</span></p><p class="c0 c2"><span class="c3"></span></p><p class="c0"><span class="c3">And because I believe in Open Source, the implementation code of each of these models will be provided along with its review.</span></p><p class="c0 c2"><span class="c3"></span></p><p class="c0"><span class="c3">Before I got into the first model I wanted to give a quick overview of the results obtained by each model, although a deeper analysis will be done for each individual model.</span></p><p class="c0 c2"><span class="c3"></span></p><p class="c0"><span class="c3">For this simple analysis I wanted to show how the error behaves against an increase of the relationship between Cross Sectional Area and Gap Length. I chose this operation because it is the one assumption made by many models in order to be accurate: Ag &gt;&gt; lg.</span></p><p class="c0 c2"><span class="c3"></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 296.00px;"><img alt="" src="images/image17.png" style="width: 601.70px; height: 296.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="Gr&aacute;fico"></span></p><p class="c0 c2"><span class="c3"></span></p><p class="c0"><span class="c3">To ease the view, the linear tendency has been drawn, and, although it is crude simplification, we can observe how all models improve the classical method of ignoring Fringing Flux; and how the error grows as the Ag / lg grows, which means that the models are less accurate for large gaps. But, as I said, the validation will be studied in more detail in further sections.</span></p><p class="c0 c2"><span class="c3"></span></p><h2 class="c17" id="h.c0p4sudh460g"><span class="c14">M&uuml;hlethaler &lsquo;s model</span></h2><p class="c0"><span class="c3">The first of these models will be the one written by Jonas M&uuml;hlethaler in his paper &ldquo;A Novel Approach for 3D Air Gap Reluctance Calculations&rdquo;</span></p><h3 class="c6" id="h.8rrztx93fzwr"><span>Jonas </span><span>M&uuml;hlethaler&rsquo;s</span><span class="c13">&nbsp;bio</span></h3><p class="c0"><span>Jonas M&uuml;hlethaler </span><span>completed</span><span class="c3">&nbsp;his studies at ETH Zurich with a PhD degree in electrical engineering with a specialization in power electronics. He then co-founded the ETH spinoff &ldquo;Gecko Simulations&rdquo;. After his entrepreneurial activities, he became active in the Swiss electricity industry, first as a consultant at AWK Group and then as R&amp;D Manager at Swissgrid. In the role of the R&amp;D Manager, he oversaw the company-wide R&amp;D portfolio as well as various R&amp;D projects. </span></p><p class="c0"><span class="c3">He joined the Institute of Electrical Engineering at the Lucerne University of Applied Sciences (HSLU) as a Lecturer in August 2020.</span></p><h3 class="c6" id="h.asmvhbdkspqw"><span class="c13">Review of the method</span></h3><p class="c0 c2"><span class="c3"></span></p><p class="c0"><span class="c3">In his paper, M&uuml;hlethaler explains how up to his knowledge there is no approach for the calculation of the Gap Reluctance that is able to take into account the three dimensionality of the core, it is simple enough to use, and includes any shape of the gap; while keeping a good accuracy. Let&rsquo;s review how his approach tries to cover all those points.</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 197.10px; height: 506.45px;"><img alt="" src="images/image14.png" style="width: 197.10px; height: 506.45px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c3">His method starts by &nbsp;defining a basic 2D reluctance, as was defined in &ldquo;Air-Gap Reluctance and Inductance Calculations for Magnetic Circuits Using a Schwarz&ndash;Christoffel Transformation&rdquo; by A. Balakrishnan, using the Schwarz-Christoffel transformation, which consists of an analogy that relates the calculation of the reluctance of a gap to the calculation of its capacitance. The author includes the full derivation of this basic 2D reluctance in an appendix.</span></p><p class="c0 c2"><span class="c3"></span></p><p class="c7"><img src="images/image1.png"></p><p class="c0 c2"><span class="c3"></span></p><p class="c0"><span class="c3">Once he has obtained this basic 2D reluctance, the author uses it as a building block to construct all the different variations of a 2D gap, which are column to column, column to corner of plate, and column to plate. Figure 1, to the right, extracted from the paper, shows the 3 different configurations.</span></p><p class="c0 c2"><span class="c3"></span></p><p class="c0"><span class="c3">Each one of this cases is defined as a simple circuit, defined in Figure 2, formed by the basic 2D reluctance defined before, and explains how to relate the model parameters to the dimensions of our magnetic core, where a and b are defined in Figure 1, and l and w are the length of the gap and the width of the column where the gap is, respectively. The solution of this simple circuit gives us the 2D reluctance of our gap.</span></p><p class="c0 c2"><span class="c3"></span></p><p class="c0"><span class="c3">But the strong point of this method is that the author extrapolates this 2D reluctance to the 3D case. In order to achieve that he separates the case of rectangular and cylindrical columns.</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 180.00px;"><img alt="" src="images/image16.png" style="width: 601.70px; height: 180.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c7"><span class="c18">Fig. 2. CIrcuits used to calculate the 2D reluctance</span></p><p class="c0 c2"><span class="c3"></span></p><p class="c0"><span class="c3">For rectangular columns, he calculates the Fringing Factor, the relationship between how much the flux is deformed while traversing the gap compared to the ideal case, for each of the two dimensions assuming that the other dimension is infinite. This is done by dividing the 2D reluctance calculated above with the simple circuit by the reluctance that the gap would have if there were no fringing effect, calculated by the classical formula:</span></p><p class="c0 c2"><span class="c3"></span></p><p class="c7"><img src="images/image2.png"></p><p class="c1 c2"><span class="c3"></span></p><p class="c1"><span>which gives a fringing factor per unit of length </span><img src="images/image3.png"><span class="c3">&nbsp;for a given dimension (x or y) of:</span></p><p class="c1 c2"><span class="c3"></span></p><p class="c7"><img src="images/image4.png"></p><p class="c1"><span>where </span><img src="images/image5.png"><span>&nbsp;is the length of the gap, </span><img src="images/image6.png"><span>&nbsp;is the width of the column in either x or y dimension, and </span><img src="images/image7.png"><span class="c3">&nbsp;is the 2D reluctance for our column.</span></p><p class="c1"><span>Finally, once the author has both reluctances, </span><img src="images/image8.png"><span>&nbsp;and </span><img src="images/image9.png"><span class="c3">, he uses both to calculate the final air gap reluctance taking into account both column dimensions:</span></p><p class="c1 c2"><span class="c3"></span></p><p class="c7"><img src="images/image10.png"></p><p class="c1 c2"><span class="c3"></span></p><p class="c1"><span class="c3">For the case of round columns, the paper adapts the aforementioned formulas, where r is the radius of the column:</span></p><p class="c7"><img src="images/image11.png"></p><p class="c7"><img src="images/image12.png"></p><p class="c1 c2"><span class="c3"></span></p><p class="c1"><span class="c3">Finally, the paper ends with a brief calculation of the reluctance of the core, noticing how it is really important to take into consideration the variability of the core permeability; and a comparison against experimental results, that has been added to the pool of measurements use in the study of all the models</span></p><h3 class="c16" id="h.ycgbdke2v5lz"><span class="c13">Verification</span></h3><p class="c1"><span class="c3">In this section I would like to see how this model fared in comparison with the classical method and the average of all the models.</span></p><p class="c1 c2"><span class="c3"></span></p><p class="c1"><span class="c3">As the author has different formulas for round and rectangular columns, I have splitted the results in those two sections.</span></p><p class="c1 c2"><span class="c3"></span></p><p class="c1"><span class="c3">If we focus our attention to rectangular columns, we can see that this model performs better in general than the average, and much better than the classical model.</span></p><p class="c1 c2"><span class="c3"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 372.00px;"><img alt="" src="images/image13.png" style="width: 601.70px; height: 372.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="Gr&aacute;fico"></span></p><p class="c1 c2"><span class="c3"></span></p><p class="c1"><span class="c3">However, if we take a look at the result for round columns, we observe how the model performs worse than the average, especially for large gaps.</span></p><p class="c1 c2"><span class="c3"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 601.70px; height: 372.00px;"><img alt="" src="images/image15.png" style="width: 601.70px; height: 372.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="Gr&aacute;fico"></span></p><p class="c1 c2"><span class="c3"></span></p><p class="c1"><span class="c3">This difference in behavior makes sense if we look at how the paper is structured, as its development looks focused on rectangular columns, being the longest and better explained part, while round columns look more like an addendum in order to generalize.</span></p><p class="c1 c2"><span class="c3"></span></p><p class="c1"><span class="c3">As a summary, I would recommend using this model for small or rectangular gaps, where its accuracy is much better than the average.</span></p><h3 class="c16" id="h.pkko3ecd6c4z"><span class="c13">Code</span></h3><p class="c1"><span class="c3">The implementation of this model was done in C++, and follows the structure defined in the Magnetic Agnostic Structure format, which incorporates a proper definition of the gap, including all the variables used in the model calculation.</span></p><p class="c1 c2"><span class="c3"></span></p><p class="c1"><span>The code is too cumbersome to be included directly in this article, but it can also be found in Github in </span><span class="c9"><a class="c8" href="https://www.google.com/url?q=https://github.com/OpenMagnetics/MKF/blob/main/src/Reluctance.cpp&amp;sa=D&amp;source=editors&amp;ust=1674387889211131&amp;usg=AOvVaw0tqSgI0D6MdvmRu8_ffQqH">https://github.com/OpenMagnetics/MKF/blob/main/src/Reluctance.cpp</a></span></p><p class="c1 c2"><span class="c3"></span></p><p class="c1"><span>The validation tests, along the data used for verification is in<br></span><span class="c9"><a class="c8" href="https://www.google.com/url?q=https://github.com/OpenMagnetics/MKF/blob/main/tests/TestReluctance.cpp&amp;sa=D&amp;source=editors&amp;ust=1674387889211593&amp;usg=AOvVaw0_77mTal0h-PknGBI6kOgN">https://github.com/OpenMagnetics/MKF/blob/main/tests/TestReluctance.cpp</a></span></p><p class="c1 c2"><span class="c3"></span></p><p class="c1"><span class="c3">If you, dear reader transformed into a programmer, have any usage or implementation doubt, don&rsquo;t hesitate to contact me, and I would gladly help.</span></p><p class="c1 c2"><span class="c3"></span></p></body></html>